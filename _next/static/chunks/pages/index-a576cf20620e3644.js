(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{8312:function(__unused_webpack_module,__unused_webpack_exports,__webpack_require__){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return __webpack_require__(2654)}])},2654:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:function(){return pages}});var jsx_runtime=__webpack_require__(5893),react=__webpack_require__(7294),react_three_fiber_esm=__webpack_require__(7188),head=__webpack_require__(9008),head_default=__webpack_require__.n(head),useGLTF=__webpack_require__(8626);let StoreModel=param=>{let{assetPrefix}=param,group=(0,react.useRef)(null),{nodes}=(0,useGLTF.L)(assetPrefix+"/models/store.glb");return(0,jsx_runtime.jsx)("group",{ref:group,dispose:null,children:Object.keys(nodes).map((key,i)=>{let node=nodes[key];return node.geometry?(0,jsx_runtime.jsx)("mesh",{castShadow:!0,receiveShadow:!0,geometry:node.geometry,material:node.material},key):null})})};var index_6f0019d1_esm=__webpack_require__(1884),TextureLoader=__webpack_require__(2001);let HeatmapModel=param=>{let{assetPrefix}=param,group=(0,react.useRef)(null),{nodes}=(0,useGLTF.L)(assetPrefix+"/models/rebuilt shop heatmap 04 8k.glb"),colorMap=(0,index_6f0019d1_esm.D)(TextureLoader.d,assetPrefix+"/textures/meredith_map flattened 02 2K.png");return(0,react.useEffect)(()=>{colorMap.flipY=!1,colorMap.generateMipmaps=!1},[colorMap]),(0,jsx_runtime.jsx)("group",{ref:group,dispose:null,children:Object.keys(nodes).map((key,i)=>{let node=nodes[key];if(!node.geometry)return null;let mat=node.material;return mat.map=colorMap,(0,jsx_runtime.jsx)("mesh",{castShadow:!0,receiveShadow:!0,geometry:node.geometry,material:mat},key)})})};var three_module=__webpack_require__(9477);let NavigationControls=param=>{let{onModeChange,cameraSensitivity}=param,{camera}=(0,index_6f0019d1_esm.z)(),[mode,setMode]=(0,react.useState)("heatmap"),velocity=(0,react.useRef)(new three_module.Vector2(0,0)),vec=(0,react.useRef)(new three_module.Vector3);return(0,react.useEffect)(()=>{let mouse={down:!1,prevTouch:[-1,-1]},handleKeyDown=ev=>{let isU="ArrowUp"===ev.key||"Up"===ev.key||"w"===ev.key,isD="ArrowDown"===ev.key||"Down"===ev.key||"s"===ev.key,isL="ArrowLeft"===ev.key||"Left"===ev.key||"a"===ev.key,isR="ArrowRight"===ev.key||"Right"===ev.key||"d"===ev.key;if(isU||isD)velocity.current.x+=(isU?1:-1)*.025;else if(isL||isR)velocity.current.y+=(isR?1:-1)*.025;else if("h"===ev.key){let nextMode="heatmap"===mode?"rgb":"heatmap";setMode(nextMode),null==onModeChange||onModeChange(nextMode)}},handleMouseMove=ev=>{if(mouse.down){var movementY=ev.movementY*Math.PI*cameraSensitivity/180,movementX=ev.movementX*Math.PI*cameraSensitivity/180;camera.rotateOnWorldAxis(new three_module.Vector3(0,1,0),three_module.MathUtils.degToRad(50*movementX)),camera.rotateX(movementY)}},handleTouchMove=ev=>{if(!mouse.down)return;let firstRun=-1===mouse.prevTouch[0]&&-1===mouse.prevTouch[1];if(!firstRun){let deltaX=ev.touches[0].pageX-mouse.prevTouch[0],deltaY=ev.touches[0].pageY-mouse.prevTouch[1];camera.rotateOnWorldAxis(new three_module.Vector3(0,1,0),three_module.MathUtils.degToRad(-50*(deltaX*Math.PI*cameraSensitivity/180))),camera.rotateX(deltaY*Math.PI*cameraSensitivity/180)}mouse.prevTouch[0]=ev.touches[0].pageX,mouse.prevTouch[1]=ev.touches[0].pageY},handleMouseDown=()=>{mouse.down=!0},handleMouseUp=()=>{mouse.down=!1,mouse.prevTouch[0]=-1,mouse.prevTouch[1]=-1};return window.addEventListener("keydown",handleKeyDown),window.addEventListener("mousemove",handleMouseMove),window.addEventListener("mousedown",handleMouseDown),window.addEventListener("mouseup",handleMouseUp),window.addEventListener("touchmove",handleTouchMove),window.addEventListener("touchstart",handleMouseDown),window.addEventListener("touchend",handleMouseUp),window.addEventListener("touchcancel",handleMouseUp),()=>{window.removeEventListener("keydown",handleKeyDown),window.removeEventListener("mousemove",handleMouseMove),window.removeEventListener("mousedown",handleMouseDown),window.removeEventListener("mouseup",handleMouseUp),window.removeEventListener("touchmove",handleTouchMove),window.removeEventListener("touchstart",handleMouseDown),window.removeEventListener("touchend",handleMouseUp),window.removeEventListener("touchcancel",handleMouseUp)}},[mode,cameraSensitivity,onModeChange]),(0,index_6f0019d1_esm.A)((state,delta,frame)=>{vec.current.setFromMatrixColumn(camera.matrix,0),vec.current.crossVectors(camera.up,vec.current),camera.position.addScaledVector(vec.current,velocity.current.x),vec.current.setFromMatrixColumn(camera.matrix,0),camera.position.addScaledVector(vec.current,velocity.current.y),velocity.current.x*=.95,velocity.current.y*=.95}),null},ASSET_PREFIX="/heatmap-visualization",HomePage=()=>{let[mode,setMode]=(0,react.useState)("heatmap"),handleViewHeatmapClick=(0,react.useCallback)(()=>setMode("heatmap"),[]),handleView3DModelClick=(0,react.useCallback)(()=>setMode("rgb"),[]);return(0,jsx_runtime.jsxs)("div",{style:{height:"100vh"},children:[(0,jsx_runtime.jsx)(head_default(),{children:(0,jsx_runtime.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1.0, maximum-scale=1.0,user-scalable=0"})}),(0,jsx_runtime.jsx)("div",{className:"buttons",children:"heatmap"===mode?(0,jsx_runtime.jsx)("button",{onClick:handleView3DModelClick,children:"View 3D Model"}):(0,jsx_runtime.jsx)("button",{onClick:handleViewHeatmapClick,children:"View Heatmap"})}),(0,jsx_runtime.jsx)("div",{style:{height:"100%"},children:(0,jsx_runtime.jsxs)(react_three_fiber_esm.Xz,{children:[(0,jsx_runtime.jsx)(NavigationControls,{onModeChange:setMode,cameraSensitivity:.2}),(0,jsx_runtime.jsx)("ambientLight",{intensity:.75}),"heatmap"===mode?(0,jsx_runtime.jsx)(HeatmapModel,{assetPrefix:ASSET_PREFIX}):(0,jsx_runtime.jsx)(StoreModel,{assetPrefix:ASSET_PREFIX})]})})]})};var pages=HomePage}},function(__webpack_require__){__webpack_require__.O(0,[737,983,774,888,179],function(){return __webpack_require__(__webpack_require__.s=8312)}),_N_E=__webpack_require__.O()}]);